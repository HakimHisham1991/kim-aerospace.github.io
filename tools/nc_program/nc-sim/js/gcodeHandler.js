/**
 * G-code handling logic
 * @module gcodeHandler
 */

/**
 * Placeholder function for G90 (Absolute Distance Mode)
 * @param {Object} state - Current machine state
 */
export function handleG90(state) {
  console.debug('G90 (Absolute Distance Mode) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G91 (Incremental Distance Mode)
 * @param {Object} state - Current machine state
 */
export function handleG91(state) {
  console.debug('G91 (Incremental Distance Mode) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G53 (Machine Coordinate System)
 * @param {Object} state - Current machine state
 */
export function handleG53(state) {
  console.debug('G53 (Machine Coordinate System) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G54 (Coordinate System 1)
 * @param {Object} state - Current machine state
 */
export function handleG54(state) {
  console.debug('G54 (Coordinate System 1) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G55 (Coordinate System 2)
 * @param {Object} state - Current machine state
 */
export function handleG55(state) {
  console.debug('G55 (Coordinate System 2) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G56 (Coordinate System 3)
 * @param {Object} state - Current machine state
 */
export function handleG56(state) {
  console.debug('G56 (Coordinate System 3) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G57 (Coordinate System 4)
 * @param {Object} state - Current machine state
 */
export function handleG57(state) {
  console.debug('G57 (Coordinate System 4) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G58 (Coordinate System 5)
 * @param {Object} state - Current machine state
 */
export function handleG58(state) {
  console.debug('G58 (Coordinate System 5) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G59 (Coordinate System 6)
 * @param {Object} state - Current machine state
 */
export function handleG59(state) {
  console.debug('G59 (Coordinate System 6) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G40 (Tool Offset Cancellation)
 * @param {Object} state - Current machine state
 */
export function handleG40(state) {
  console.debug('G40 (Tool Offset Cancellation) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G41 (Tool Offset Left)
 * @param {Object} state - Current machine state
 */
export function handleG41(state) {
  console.debug('G41 (Tool Offset Left) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G42 (Tool Offset Right)
 * @param {Object} state - Current machine state
 */
export function handleG42(state) {
  console.debug('G42 (Tool Offset Right) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G43 (Tool Length Compensation Positive)
 * @param {Object} state - Current machine state
 */
export function handleG43(state) {
  console.debug('G43 (Tool Length Compensation Positive) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G44 (Tool Length Compensation Negative)
 * @param {Object} state - Current machine state
 */
export function handleG44(state) {
  console.debug('G44 (Tool Length Compensation Negative) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G49 (Tool Length Compensation Cancel)
 * @param {Object} state - Current machine state
 */
export function handleG49(state) {
  console.debug('G49 (Tool Length Compensation Cancel) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G98 (Initial Level Return)
 * @param {Object} state - Current machine state
 */
export function handleG98(state) {
  console.debug('G98 (Initial Level Return) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G99 (R Point Level Return)
 * @param {Object} state - Current machine state
 */
export function handleG99(state) {
  console.debug('G99 (R Point Level Return) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G68 (Coordinate System Rotation)
 * @param {Object} state - Current machine state
 */
export function handleG68(state) {
  console.debug('G68 (Coordinate System Rotation) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G69 (Coordinate System Rotation Cancel)
 * @param {Object} state - Current machine state
 */
export function handleG69(state) {
  console.debug('G69 (Coordinate System Rotation Cancel) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G80 (Canned Cycle Cancel)
 * @param {Object} state - Current machine state
 */
export function handleG80(state) {
  console.debug('G80 (Canned Cycle Cancel) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G81 (Drilling Cycle)
 * @param {Object} state - Current machine state
 */
export function handleG81(state) {
  console.debug('G81 (Drilling Cycle) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G82 (Drilling Cycle with Dwell)
 * @param {Object} state - Current machine state
 */
export function handleG82(state) {
  console.debug('G82 (Drilling Cycle with Dwell) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G83 (Peck Deep Drilling Cycle)
 * @param {Object} state - Current machine state
 */
export function handleG83(state) {
  console.debug('G83 (Deep Drilling Cycle with Peck) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G84 (Tapping Cycle)
 * @param {Object} state - Current machine state
 */
export function handleG84(state) {
  console.debug('G84 (Tapping Cycle) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G85 (Boring Cycle, Feed Out)
 * @param {Object} state - Current machine state
 */
export function handleG85(state) {
  console.debug('G85 (Boring Cycle, Feed Out) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G86 (Boring Cycle, Spindle Stop, Rapid Out)
 * @param {Object} state - Current machine state
 */
export function handleG86(state) {
  console.debug('G86 (Boring Cycle, Spindle Stop, Rapid Out) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G87 (Back Boring Cycle)
 * @param {Object} state - Current machine state
 */
export function handleG87(state) {
  console.debug('G87 (Back Boring Cycle) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G88 (Boring Cycle, Spindle Stop, Manual Out)
 * @param {Object} state - Current machine state
 */
export function handleG88(state) {
  console.debug('G88 (Boring Cycle, Spindle Stop, Manual Out) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G89 (Boring Cycle, Dwell, Feed Out)
 * @param {Object} state - Current machine state
 */
export function handleG89(state) {
  console.debug('G89 (Boring Cycle, Dwell, Feed Out) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G73 (High-Speed Peck Drilling Cycle)
 * @param {Object} state - Current machine state
 */
export function handleG73(state) {
  console.debug('G73 (High-Speed Peck Drilling Cycle) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G74 (Tapping Cycle Reversed)
 * @param {Object} state - Current machine state
 */
export function handleG74(state) {
  console.debug('G74 (Tapping Cycle Reversed) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Placeholder function for G76 (Fine Boring Cycle)
 * @param {Object} state - Current machine state
 */
export function handleG76(state) {
  console.debug('G76 (Fine Boring Cycle) activated - placeholder, no effect on calculations');
  // Placeholder: No effect on rendering or calculations
}

/**
 * Handles G-code logic and updates state
 * @param {Object} state - Current machine state
 * @param {string} gCode - G-code to process
 * @param {Object} tokenData - Token data from processTokens
 * @param {number} index - Line index
 * @returns {Object} Result object with skip flag
 */
export function handleGCode(state, gCode, tokenData, index) {
  let skip = false;

  if (['G00', 'G01', 'G02', 'G03'].includes(gCode)) {
    state.currentMode = gCode;
    state.activeGCodes.motion = gCode;
  } else if (['G17', 'G18', 'G19'].includes(gCode)) {
    state.activeGCodes.plane = gCode;
  } else if (['G20', 'G21'].includes(gCode)) {
    state.activeGCodes.units = gCode;
  } else if (['G90', 'G91'].includes(gCode)) {
    state.activeGCodes.distanceMode = gCode;
    if (gCode === 'G90') handleG90(state);
    if (gCode === 'G91') handleG91(state);
    console.debug(`Updated activeGCodes.distanceMode to ${gCode} at line ${index + 1}`);
  } else if (['G93', 'G94', 'G95'].includes(gCode)) {
    state.activeGCodes.feedMode = gCode;
    console.debug(`Updated activeGCodes.feedMode to ${gCode} at line ${index + 1}`);
  } else if (['G53', 'G54', 'G55', 'G56', 'G57', 'G58', 'G59'].includes(gCode)) {
    if (gCode === 'G53') {
      state.activeGCodes.coordinateSystem = gCode;
      handleG53(state);
      console.debug(`Set activeGCodes.coordinateSystem to G53 (non-modal) at line ${index + 1}, previous was ${state.previousCoordinateSystem}`);
    } else {
      state.activeGCodes.coordinateSystem = gCode;
      state.previousCoordinateSystem = gCode; // Update previous only for modal codes
      if (gCode === 'G54') handleG54(state);
      if (gCode === 'G55') handleG55(state);
      if (gCode === 'G56') handleG56(state);
      if (gCode === 'G57') handleG57(state);
      if (gCode === 'G58') handleG58(state);
      if (gCode === 'G59') handleG59(state);
      console.debug(`Updated activeGCodes.coordinateSystem to ${gCode} at line ${index + 1}`);
    }
  } else if (['G40', 'G41', 'G42'].includes(gCode)) {
    state.activeGCodes.toolOffset = gCode;
    if (gCode === 'G40') handleG40(state);
    if (gCode === 'G41') handleG41(state);
    if (gCode === 'G42') handleG42(state);
    console.debug(`Updated activeGCodes.toolOffset to ${gCode} at line ${index + 1}`);
  } else if (['G43', 'G44', 'G49'].includes(gCode)) {
    state.activeGCodes.toolLength = gCode;
    if (gCode === 'G43') handleG43(state);
    if (gCode === 'G44') handleG44(state);
    if (gCode === 'G49') handleG49(state);
    console.debug(`Updated activeGCodes.toolLength to ${gCode} at line ${index + 1}`);
  } else if (['G98', 'G99'].includes(gCode)) {
    state.activeGCodes.retractPlane = gCode;
    if (gCode === 'G98') handleG98(state);
    if (gCode === 'G99') handleG99(state);
    console.debug(`Updated activeGCodes.retractPlane to ${gCode} at line ${index + 1}`);
  } else if (['G68', 'G69'].includes(gCode)) {
    state.activeGCodes.rotation = gCode;
    if (gCode === 'G68') handleG68(state);
    if (gCode === 'G69') handleG69(state);
    console.debug(`Updated activeGCodes.rotation to ${gCode} at line ${index + 1}`);
  } else if (['G80', 'G81', 'G82', 'G83', 'G84', 'G85', 'G86', 'G87', 'G88', 'G89', 'G73', 'G74', 'G76'].includes(gCode)) {
    state.activeGCodes.holeCycle = gCode;
    if (gCode === 'G80') handleG80(state);
    if (gCode === 'G81') handleG81(state);
    if (gCode === 'G82') handleG82(state);
    if (gCode === 'G83') handleG83(state);
    if (gCode === 'G84') handleG84(state);
    if (gCode === 'G85') handleG85(state);
    if (gCode === 'G86') handleG86(state);
    if (gCode === 'G87') handleG87(state);
    if (gCode === 'G88') handleG88(state);
    if (gCode === 'G89') handleG89(state);
    if (gCode === 'G73') handleG73(state);
    if (gCode === 'G74') handleG74(state);
    if (gCode === 'G76') handleG76(state);
    console.debug(`Updated activeGCodes.holeCycle to ${gCode} at line ${index + 1}`);
  } else {
    skip = true;
  }

  return { skip };
}